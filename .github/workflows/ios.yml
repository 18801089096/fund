name: Build iOS App

on:
  workflow_dispatch:  # 允许手动点击按钮触发

jobs:
  build:
    runs-on: macos-latest
    permissions:
      contents: read
      actions: write

    steps:
    - uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: "3.10"

    - name: Install Briefcase
      run: pip install briefcase

    - name: Create iOS App Template
      run: briefcase create iOS --no-input

    - name: Build iOS App
      run: briefcase build iOS

    - name: Package iOS App (Ad-hoc)
      run: briefcase package iOS --adhoc

    - name: Upload IPA
      uses: actions/upload-artifact@v4
      with:
        name: LanFund-IPA
        path: build/fundapp/ios/xcode/build/Debug-iphoneos/*.ipa
